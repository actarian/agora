{"version":3,"file":"src/js/main.server.js","sources":["../../src/js/environment/environment.js","../../src/js/main.server.js"],"sourcesContent":["export const STATIC = window.location.port === '41999' || window.location.host === 'actarian.github.io';\r\nexport const DEVELOPMENT = ['localhost', '127.0.0.1', '0.0.0.0'].indexOf(window.location.host.split(':')[0]) !== -1;\r\nexport const PRODUCTION = !DEVELOPMENT;\r\nexport const ENV = {\r\n\tSTATIC,\r\n\tDEVELOPMENT,\r\n\tPRODUCTION\r\n};\r\n","const express = require('express');\nconst path = require('path');\nconst PORT = process.env.PORT || 5000;\nconst { RtcTokenBuilder, RtmTokenBuilder, RtcRole, RtmRole } = require('agora-access-token');\nconst environment = require('./environment/environment');\n\nvar app = express();\n\napp.disable('x-powered-by');\n\napp.use(express.favicon());\n\napp.use(express.static(path.join(__dirname, 'docs')));\n\n/*\napp.set('views', path.join(__dirname, 'views'));\napp.set('view engine', 'ejs');\napp.get('/', (request, response) => response.render('pages/index'));\n*/\n\n/*\napp.get('/', function(request, response) {\n\tresponse.send('Hello World!');\n});\n*/\n\napp.post('/api/token/rtc', function(request, response) {\n\tconst duration = 3600;\n\tconst timestamp = Math.floor(Date.now() / 1000);\n\tconst expirationTime = timestamp + duration;\n\tconst uid = request.uid || timestamp;\n\tconst role = RtcRole.PUBLISHER;\n\tconst token = RtcTokenBuilder.buildTokenWithUid(environment.appKey, environment.appCertificate, environment.channelName, uid, role, expirationTime);\n\tconsole.log('/api/token/rtc', token);\n\tresponse.send(JSON.stringify({\n\t\ttoken: token,\n\t}));\n});\n\napp.post('/api/token/rtm', function(request, response) {\n\tconst duration = 3600;\n\tconst timestamp = Math.floor(Date.now() / 1000);\n\tconst expirationTime = timestamp + duration;\n\tconst uid = request.uid || timestamp;\n\tconst role = RtmRole.PUBLISHER;\n\tconst token = RtmTokenBuilder.buildTokenWithUid(environment.appKey, environment.appCertificate, environment.channelName, uid, role, expirationTime);\n\tconsole.log('/api/token/rtm', token);\n\tresponse.send(JSON.stringify({\n\t\ttoken: token,\n\t}));\n});\n\napp.listen(PORT, () => {\n\tconsole.log(`Listening on ${ PORT }`);\n});\n\n// IMPORTANT! Build token with either the uid or with the user account. Comment out the option you do not want to use below.\n\n// Build token with uid\n// const token = RtcTokenBuilder.buildTokenWithUid(environment.appKey, environment.appCertificate, environment.channelName, uid, role, expirationTime);\n\n// Build token with user account\n// const token = RtcTokenBuilder.buildTokenWithAccount(environment.appKey, environment.appCertificate, environment.channelName, account, role, expirationTime);\n"],"names":["STATIC","window","location","port","host","DEVELOPMENT","indexOf","split","PRODUCTION","ENV","PORT","process","env","RtcTokenBuilder","require$$0","RtmTokenBuilder","RtcRole","RtmRole","app","express","disable","use","favicon","static","path","join","__dirname","post","request","response","duration","timestamp","Math","floor","Date","now","expirationTime","uid","role","PUBLISHER","token","buildTokenWithUid","environment","appKey","appCertificate","channelName","console","log","send","JSON","stringify","listen"],"mappings":"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"}